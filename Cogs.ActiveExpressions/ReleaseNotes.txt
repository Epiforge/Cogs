We converted every foreach loop over objects with indexers into for loops to increase performance and reduce allocations.